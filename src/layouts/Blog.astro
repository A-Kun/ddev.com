---
import {
  formatDate,
  getAuthorUrl,
  getAuthorImage,
  getCategoryUrl,
} from "./../lib/api"
import Layout from "./../layouts/Layout.astro"
import PostBody from "./../components/PostBody.astro"
import Heading from "./../components/Heading.astro"
import BlogPostFooter from "./../components/BlogPostFooter.astro"

const { frontmatter, url } = Astro.props
const { slug } = Astro.params

const authorImage = getAuthorImage(frontmatter.author)

console.log(authorImage)
---

<Layout title={frontmatter.title}>
  <main class="max-w-4xl mx-auto mb-24">
    <Heading
      title={frontmatter.title}
      date={formatDate(frontmatter.pubDate, { month: "long" })}
      author={frontmatter.author}
      authorUrl={getAuthorUrl(frontmatter.author)}
      authorAvatar={authorImage}
      readTime={frontmatter.minutesRead}
    />
    <div class="flex">
      <div class="w-2/3">
        <PostBody>
          <slot />
        </PostBody>
      </div>
      <div class="w-1/3 pl-24 mt-6">
        {
          frontmatter.categories.length && (
            <>
              <span class="font-mono text-sm block text-navy-300 tracking-wider">
                Posted In
              </span>
              <ul class="mt-1">
                {frontmatter.categories.map((category) => (
                  <li class="my-1">
                    <a href={getCategoryUrl(category)} class="font-bold">
                      {category}
                    </a>
                  </li>
                ))}
              </ul>
            </>
          )
        }
      </div>
    </div>
  </main>
  <BlogPostFooter slug={slug} />
</Layout>
